<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>تحليل المشاعر - all-MiniLM-L6-v2</title>
<style>
body { font-family: Arial; padding: 20px; direction: rtl; }
input, button { padding: 10px; font-size: 16px; margin-top: 10px; width: 100%; }
#results { margin-top: 20px; font-weight: bold; }
.status { margin-top: 10px; font-style: italic; }
.positive { color: green; }
.negative { color: red; }
.neutral { color: gray; }
</style>
<script type="module">
import * as transformers from 'https://cdn.jsdelivr.net/npm/@xenova/transformers@2.3.0/dist/transformers.min.js';

let classifier;

async function init() {
  const status = document.getElementById('status');
  status.innerText = "تحميل النموذج الكبير (قد يستغرق وقتًا)...";
  try {
    classifier = await transformers.pipeline(
      "text-classification",
      "./models/all-MiniLM-L6-v2-onnx"
    );
    status.innerText = "النموذج جاهز الآن ✅";
  } catch(e) {
    status.innerText = "حدث خطأ أثناء التحميل ❌";
    console.error(e);
  }
}

async function analyze() {
  const text = document.getElementById('inputText').value;
  if (!text) return;
  document.getElementById('results').innerText = "جارٍ التحليل...";
  const result = await classifier(text);
  const label = result[0].label;
  const score = (result[0].score*100).toFixed(1);

  let color = "neutral";
  let arabicLabel = "محايد";
  if(label==="POSITIVE"){arabicLabel="إيجابي"; color="positive";}
  if(label==="NEGATIVE"){arabicLabel="سلبي"; color="negative";}

  document.getElementById('results').innerHTML = `<span class="${color}">النتيجة: ${arabicLabel} (${score}%)</span>`;
}

window.addEventListener('DOMContentLoaded', init);
</script>
</head>
<body>
<h1>تحليل المشاعر - all-MiniLM-L6-v2</h1>
<p class="status" id="status">جارٍ تحميل الصفحة...</p>
<input type="text" id="inputText" placeholder="اكتب النص هنا">
<button onclick="analyze()">تحليل المشاعر</button>
<div id="results"></div>
</body>
</html>
